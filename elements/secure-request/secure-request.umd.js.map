{"version":3,"file":"secure-request.umd.js","sources":["secure-request.umd.js"],"sourcesContent":["/**\n * `secure-request`\n * @element secure-request\n * `Wrapper behavior to provide the basis for a secure XHR`\n *\n * @demo demo/index.html\n * @polymerBehavior\n * @polymer\n */\n// superclass element mix in\nexport const SecureRequestXhr = function(SuperClass) {\n  return class extends SuperClass {\n    /**\n     * Set cookies for the request\n     */\n    setCookies(endPoint, csrfToken) {\n      this._eraseCookie(\"securerequest-endpoint\");\n      this._eraseCookie(\"securerequest-csrftoken\");\n      this._createCookie(\"securerequest-endpoint\", endPoint, 30, endPoint);\n      this._createCookie(\"securerequest-csrftoken\", csrfToken, 30, endPoint);\n    }\n    // call this function from your child components to generate secure urls\n    generateUrl(url) {\n      const endPoint = this.getEndPoint();\n      const csrfToken = this.getCsrfToken();\n      if (endPoint && csrfToken) {\n        return endPoint + url + \"?token=\" + csrfToken;\n      }\n      return null;\n    }\n    getEndPoint() {\n      return this._readCookie(\"securerequest-endpoint\");\n    }\n    getCsrfToken() {\n      return this._readCookie(\"securerequest-csrftoken\");\n    }\n    _createCookie(name, value, days, path) {\n      var expires = \"\";\n      if (days) {\n        var date = new Date();\n        date.setTime(date.getTime() + days * 24 * 60 * 60 * 1000);\n        expires = \"; expires=\" + date.toUTCString();\n      }\n      document.cookie = name + \"=\" + value + expires + \"; path=\" + path;\n    }\n    _readCookie(name) {\n      var nameEQ = name + \"=\";\n      var ca = document.cookie.split(\";\");\n      for (var i = 0; i < ca.length; i++) {\n        var c = ca[i];\n        while (c.charAt(0) == \" \") c = c.substring(1, c.length);\n        if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);\n      }\n      return null;\n    }\n    _eraseCookie(name) {\n      this._createCookie(name, \"\", -1);\n    }\n  };\n};\nwindow.SecureRequest = window.SecureRequest || {};\nwindow.SecureRequest.xhr = {\n  // Call this function in your root component.\n  setCookies(endPoint, csrfToken) {\n    this._eraseCookie(\"securerequest-endpoint\");\n    this._eraseCookie(\"securerequest-csrftoken\");\n    this._createCookie(\"securerequest-endpoint\", endPoint, 30, endPoint);\n    this._createCookie(\"securerequest-csrftoken\", csrfToken, 30, endPoint);\n  },\n  // call this function from your child components to generate secure urls\n  generateUrl(url) {\n    const endPoint = this.getEndPoint();\n    const csrfToken = this.getCsrfToken();\n    if (endPoint && csrfToken) {\n      return endPoint + url + \"?token=\" + csrfToken;\n    }\n    return null;\n  },\n  getEndPoint() {\n    return this._readCookie(\"securerequest-endpoint\");\n  },\n  getCsrfToken() {\n    return this._readCookie(\"securerequest-csrftoken\");\n  },\n  _createCookie(name, value, days, path) {\n    var expires = \"\";\n    if (days) {\n      var date = new Date();\n      date.setTime(date.getTime() + days * 24 * 60 * 60 * 1000);\n      expires = \"; expires=\" + date.toUTCString();\n    }\n    document.cookie = name + \"=\" + value + expires + \"; path=\" + path;\n  },\n  _readCookie(name) {\n    var nameEQ = name + \"=\";\n    var ca = document.cookie.split(\";\");\n    for (var i = 0; i < ca.length; i++) {\n      var c = ca[i];\n      while (c.charAt(0) == \" \") c = c.substring(1, c.length);\n      if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);\n    }\n    return null;\n  },\n  _eraseCookie(name) {\n    this._createCookie(name, \"\", -1);\n  }\n};\n"],"names":["window","SecureRequest","xhr","setCookies","endPoint","csrfToken","_eraseCookie","_createCookie","generateUrl","url","this","getEndPoint","getCsrfToken","_readCookie","name","value","days","path","expires","date","Date","setTime","getTime","toUTCString","document","cookie","nameEQ","ca","split","i","length","c","charAt","substring","indexOf","SuperClass"],"mappings":"+wBA4DAA,OAAOC,cAAgBD,OAAOC,eAAiB,GAC/CD,OAAOC,cAAcC,IAAM,CAEzBC,oBAAWC,EAAUC,QACdC,aAAa,+BACbA,aAAa,gCACbC,cAAc,yBAA0BH,EAAU,GAAIA,QACtDG,cAAc,0BAA2BF,EAAW,GAAID,IAG/DI,qBAAYC,OACJL,EAAWM,KAAKC,cAChBN,EAAYK,KAAKE,sBACnBR,GAAYC,EACPD,EAAWK,EAAM,UAAYJ,EAE/B,MAETM,8BACSD,KAAKG,YAAY,2BAE1BD,+BACSF,KAAKG,YAAY,4BAE1BN,uBAAcO,EAAMC,EAAOC,EAAMC,OAC3BC,EAAU,MACVF,EAAM,KACJG,EAAO,IAAIC,KACfD,EAAKE,QAAQF,EAAKG,UAAmB,GAAPN,EAAY,GAAK,GAAK,KACpDE,EAAU,aAAeC,EAAKI,cAEhCC,SAASC,OAASX,EAAO,IAAMC,EAAQG,EAAU,UAAYD,GAE/DJ,qBAAYC,WACNY,EAASZ,EAAO,IAChBa,EAAKH,SAASC,OAAOG,MAAM,KACtBC,EAAI,EAAGA,EAAIF,EAAGG,OAAQD,IAAK,SAC9BE,EAAIJ,EAAGE,GACW,KAAfE,EAAEC,OAAO,IAAWD,EAAIA,EAAEE,UAAU,EAAGF,EAAED,WACvB,GAArBC,EAAEG,QAAQR,GAAc,OAAOK,EAAEE,UAAUP,EAAOI,OAAQC,EAAED,eAE3D,MAETxB,sBAAaQ,QACNP,cAAcO,EAAM,IAAK,wBA9FF,SAASqB,waAClBA,4CAIR/B,EAAUC,QACdC,aAAa,+BACbA,aAAa,gCACbC,cAAc,yBAA0BH,EAAU,GAAIA,QACtDG,cAAc,0BAA2BF,EAAW,GAAID,uCAGnDK,OACJL,EAAWM,KAAKC,cAChBN,EAAYK,KAAKE,sBACnBR,GAAYC,EACPD,EAAWK,EAAM,UAAYJ,EAE/B,kDAGAK,KAAKG,YAAY,wEAGjBH,KAAKG,YAAY,iEAEZC,EAAMC,EAAOC,EAAMC,OAC3BC,EAAU,MACVF,EAAM,KACJG,EAAO,IAAIC,KACfD,EAAKE,QAAQF,EAAKG,UAAmB,GAAPN,EAAY,GAAK,GAAK,KACpDE,EAAU,aAAeC,EAAKI,cAEhCC,SAASC,OAASX,EAAO,IAAMC,EAAQG,EAAU,UAAYD,sCAEnDH,WACNY,EAASZ,EAAO,IAChBa,EAAKH,SAASC,OAAOG,MAAM,KACtBC,EAAI,EAAGA,EAAIF,EAAGG,OAAQD,IAAK,SAC9BE,EAAIJ,EAAGE,GACW,KAAfE,EAAEC,OAAO,IAAWD,EAAIA,EAAEE,UAAU,EAAGF,EAAED,WACvB,GAArBC,EAAEG,QAAQR,GAAc,OAAOK,EAAEE,UAAUP,EAAOI,OAAQC,EAAED,eAE3D,0CAEIhB,QACNP,cAAcO,EAAM,IAAK"}