{"version":3,"file":"drag-n-drop.umd.js","sources":["drag-n-drop.umd.js"],"sourcesContent":["/**\n * Copyright 2019 The Pennsylvania State University\n * @license Apache-2.0, see License.md for full text.\n *\n * Inspiration from: https://codepen.io/bradtraversy/pen/odmVgN\n */\n\n/**\n * `drag-n-drop`\n * @element drag-n-drop\n * `drag and drop elements and manager`\n *\n * @microcopy - language worth noting:\n *  -\n *\n\n * @demo demo/index.html\n */\nclass DragNDrop extends HTMLElement {\n  \n  // render function\n  get html() {\n    return `\n<style>\n:host {\n  display: block;\n}\n\n:host([hidden]) {\n  display: none;\n}\n\n:host([editing]) .items ::slotted(.hold) {\n  border: solid 5px #ccc;\n}\n\n:host([editing]) .items ::slotted([data-droppable]) {\n  margin: 10px;\n  border: solid 3px salmon;\n  background: white;\n}\n\n:host([editing]) .items ::slotted(.hovered) {\n  background: #f4f4f4;\n  border-style: dashed;\n}\n        </style>\n<div class=\"items\">\n  <slot></slot>\n</div>`;\n  }\n\n  // properties available to the custom element for data binding\n    static get properties() {\n    return {\n  \n  ...super.properties,\n  \n  \"editing\": {\n    \"name\": \"editing\",\n    \"type\": Boolean\n  }\n}\n;\n  }\n\n  /**\n   * Store the tag name to make it easier to obtain directly.\n   * @notice function name must be here for tooling to operate correctly\n   */\n  static get tag() {\n    return \"drag-n-drop\";\n  }\n  /**\n   * life cycle\n   */\n  constructor(delayRender = false) {\n    super();\n    // dragging tracker\n    this.__dragging = {};\n    // set tag for later use\n    this.tag = DragNDrop.tag;\n    // map our imported properties json to real props on the element\n    // @notice static getter of properties is built via tooling\n    // to edit modify src/DragNDrop-properties.json\n    let obj = DragNDrop.properties;\n    for (let p in obj) {\n      if (obj.hasOwnProperty(p)) {\n        if (this.hasAttribute(p)) {\n          this[p] = this.getAttribute(p);\n        } else {\n          this.setAttribute(p, obj[p].value);\n          this[p] = obj[p].value;\n        }\n      }\n    }\n    this.template = document.createElement(\"template\");\n\n    this.attachShadow({ mode: \"open\" });\n\n    if (!delayRender) {\n      this.render();\n    }\n  }\n  /**\n   * life cycle, element is afixed to the DOM\n   */\n  connectedCallback() {\n    if (window.ShadyCSS) {\n      window.ShadyCSS.styleElement(this);\n    }\n  }\n\n  _copyAttribute(name, to) {\n    const recipients = this.shadowRoot.querySelectorAll(to);\n    const value = this.getAttribute(name);\n    const fname = value == null ? \"removeAttribute\" : \"setAttribute\";\n    for (const node of recipients) {\n      node[fname](name, value);\n    }\n  }\n\n  _setProperty({ name, value }) {\n    this[name] = value;\n  }\n\n  render() {\n    this.shadowRoot.innerHTML = null;\n    this.template.innerHTML = this.html;\n\n    if (window.ShadyCSS) {\n      window.ShadyCSS.prepareTemplate(this.template, this.tag);\n    }\n    this.shadowRoot.appendChild(this.template.content.cloneNode(true));\n  }\n\n  static get observedAttributes() {\n    return [\"editing\"];\n  }\n  get editing() {\n    this.getAttribute(\"editing\");\n  }\n  set editing(val) {\n    if (!val) {\n      this.removeAttribute(\"editing\");\n    } else {\n      this.setAttribute(\"editing\", val);\n    }\n  }\n  // disconnectedCallback() {}\n  attributeChangedCallback(attr, oldValue, newValue) {\n    if (attr === \"editing\") {\n      const draggable = this.querySelectorAll(\"[data-draggable]\");\n      const droppable = this.querySelectorAll(\"[data-droppable]\");\n      if (newValue) {\n        // Loop through empty boxes and add listeners\n        for (const dropArea of droppable) {\n          dropArea.setAttribute(\"droppable\", \"true\");\n          dropArea.addEventListener(\"dragover\", this.dragOver.bind(this));\n          dropArea.addEventListener(\"dragenter\", this.dragEnter.bind(this));\n          dropArea.addEventListener(\"dragleave\", this.dragLeave.bind(this));\n          dropArea.addEventListener(\"drop\", this.dragDrop.bind(this));\n        }\n        // Loop through fills and add listeners\n        for (const dragItem of draggable) {\n          dragItem.setAttribute(\"draggable\", \"true\");\n          dragItem.addEventListener(\"dragstart\", this.dragStart.bind(this));\n          dragItem.addEventListener(\"dragend\", this.dragEnd.bind(this));\n        }\n      } else {\n        // Loop through empty boxes and add listeners\n        for (const dropArea of droppable) {\n          dropArea.removeAttribute(\"droppable\");\n          dropArea.removeEventListener(\"dragover\", this.dragOver.bind(this));\n          dropArea.removeEventListener(\"dragenter\", this.dragEnter.bind(this));\n          dropArea.removeEventListener(\"dragleave\", this.dragLeave.bind(this));\n          dropArea.removeEventListener(\"drop\", this.dragDrop.bind(this));\n        }\n        // Loop through fills and add listeners\n        for (const dragItem of draggable) {\n          dragItem.removeAttribute(\"draggable\");\n          dragItem.removeEventListener(\"dragstart\", this.dragStart.bind(this));\n          dragItem.removeEventListener(\"dragend\", this.dragEnd.bind(this));\n        }\n      }\n    }\n  }\n\n  // Drag Functions\n  dragStart(e) {\n    this.__dragging = e.target;\n    this.__dragging.className += \" hold\";\n    setTimeout(() => (this.__dragging.className = \"invisible\"), 0);\n    e.stopPropagation();\n    e.stopImmediatePropagation();\n  }\n\n  dragEnd(e) {\n    this.__dragging.className = \"fill\";\n  }\n  dragOver(e) {\n    e.preventDefault();\n  }\n  dragEnter(e) {\n    e.preventDefault();\n    e.target.className += \" hovered\";\n  }\n  dragLeave(e) {\n    e.target.className = \"empty\";\n  }\n  dragDrop(e) {\n    e.target.className = \"empty\";\n    e.target.appendChild(this.__dragging);\n  }\n}\nwindow.customElements.define(DragNDrop.tag, DragNDrop);\nexport { DragNDrop };\n"],"names":["DragNDrop","delayRender","__dragging","tag","obj","properties","p","hasOwnProperty","_this","hasAttribute","getAttribute","setAttribute","value","template","document","createElement","attachShadow","mode","render","HTMLElement","Boolean","window","ShadyCSS","styleElement","this","name","to","recipients","shadowRoot","querySelectorAll","fname","innerHTML","html","prepareTemplate","appendChild","content","cloneNode","attr","oldValue","newValue","draggable","droppable","dropArea","addEventListener","dragOver","bind","dragEnter","dragLeave","dragDrop","dragItem","dragStart","dragEnd","removeAttribute","removeEventListener","e","target","className","setTimeout","_this2","stopPropagation","stopImmediatePropagation","preventDefault","val","customElements","define"],"mappings":"q2EAkBMA,iCA0DQC,4LAGLC,WAAa,KAEbC,IAAMH,EAAUG,QAIjBC,EAAMJ,EAAUK,eACf,IAAIC,KAAKF,EACRA,EAAIG,eAAeD,KACjBE,EAAKC,aAAaH,KACfA,GAAKE,EAAKE,aAAaJ,MAEvBK,aAAaL,EAAGF,EAAIE,GAAGM,SACvBN,GAAKF,EAAIE,GAAGM,iBAIlBC,SAAWC,SAASC,cAAc,cAElCC,aAAa,CAAEC,KAAM,SAErBhB,KACEiB,yPAnFaC,w6BAwCX,MACD,eACAC,6CAWD,iEAqCHC,OAAOC,UACTD,OAAOC,SAASC,aAAaC,6CAIlBC,EAAMC,OACbC,EAAaH,KAAKI,WAAWC,iBAAiBH,GAC9Cd,EAAQY,KAAKd,aAAae,GAC1BK,EAAiB,MAATlB,EAAgB,kBAAoB,kDAC/Be,iDAAY,SACxBG,GAAOL,EAAMb,mIAIPa,IAAAA,KAAMb,IAAAA,WACda,GAAQb,wCAIRgB,WAAWG,UAAY,UACvBlB,SAASkB,UAAYP,KAAKQ,KAE3BX,OAAOC,UACTD,OAAOC,SAASW,gBAAgBT,KAAKX,SAAUW,KAAKrB,UAEjDyB,WAAWM,YAAYV,KAAKX,SAASsB,QAAQC,WAAU,qDAiBrCC,EAAMC,EAAUC,MAC1B,YAATF,EAAoB,KAChBG,EAAYhB,KAAKK,iBAAiB,oBAClCY,EAAYjB,KAAKK,iBAAiB,uBACpCU,EAAU,wCAEWE,iDAAW,KAAvBC,UACTA,EAAS/B,aAAa,YAAa,QACnC+B,EAASC,iBAAiB,WAAYnB,KAAKoB,SAASC,KAAKrB,OACzDkB,EAASC,iBAAiB,YAAanB,KAAKsB,UAAUD,KAAKrB,OAC3DkB,EAASC,iBAAiB,YAAanB,KAAKuB,UAAUF,KAAKrB,OAC3DkB,EAASC,iBAAiB,OAAQnB,KAAKwB,SAASH,KAAKrB,iIAGhCgB,iDAAW,KAAvBS,UACTA,EAAStC,aAAa,YAAa,QACnCsC,EAASN,iBAAiB,YAAanB,KAAK0B,UAAUL,KAAKrB,OAC3DyB,EAASN,iBAAiB,UAAWnB,KAAK2B,QAAQN,KAAKrB,+FAEpD,wCAEkBiB,iDAAW,KAAvBC,UACTA,EAASU,gBAAgB,aACzBV,EAASW,oBAAoB,WAAY7B,KAAKoB,SAASC,KAAKrB,OAC5DkB,EAASW,oBAAoB,YAAa7B,KAAKsB,UAAUD,KAAKrB,OAC9DkB,EAASW,oBAAoB,YAAa7B,KAAKuB,UAAUF,KAAKrB,OAC9DkB,EAASW,oBAAoB,OAAQ7B,KAAKwB,SAASH,KAAKrB,iIAGnCgB,iDAAW,KAAvBS,UACTA,EAASG,gBAAgB,aACzBH,EAASI,oBAAoB,YAAa7B,KAAK0B,UAAUL,KAAKrB,OAC9DyB,EAASI,oBAAoB,UAAW7B,KAAK2B,QAAQN,KAAKrB,+HAOxD8B,mBACHpD,WAAaoD,EAAEC,YACfrD,WAAWsD,WAAa,QAC7BC,WAAW,kBAAOC,EAAKxD,WAAWsD,UAAY,aAAc,GAC5DF,EAAEK,kBACFL,EAAEM,2DAGIN,QACDpD,WAAWsD,UAAY,wCAErBF,GACPA,EAAEO,mDAEMP,GACRA,EAAEO,iBACFP,EAAEC,OAAOC,WAAa,6CAEdF,GACRA,EAAEC,OAAOC,UAAY,yCAEdF,GACPA,EAAEC,OAAOC,UAAY,QACrBF,EAAEC,OAAOrB,YAAYV,KAAKtB,iDAxErBQ,aAAa,yBAERoD,GACLA,OAGEnD,aAAa,UAAWmD,QAFxBV,gBAAgB,8DAPhB,CAAC,oBA8EZ/B,OAAO0C,eAAeC,OAAOhE,EAAUG,IAAKH"}