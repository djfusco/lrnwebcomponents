{"version":3,"file":"paper-search.umd.js","sources":["lib/paper-search-bar.js","lib/paper-filter-dialog.js","lib/paper-search-panel.js"],"sourcesContent":["import { html, PolymerElement } from \"@polymer/polymer/polymer-element.js\";\nimport { afterNextRender } from \"@polymer/polymer/lib/utils/render-status.js\";\nimport { mixinBehaviors } from \"@polymer/polymer/lib/legacy/class.js\";\nimport { IronA11yKeysBehavior } from \"@polymer/iron-a11y-keys-behavior/iron-a11y-keys-behavior.js\";\n\nclass PaperSearchBar extends mixinBehaviors(\n  [IronA11yKeysBehavior],\n  PolymerElement\n) {\n  static get tag() {\n    return \"paper-search-bar\";\n  }\n  /**\n   * Fired when the user requests to open the filtering dialog\n   *\n   * @event paper-search-filter\n   */\n  /**\n   * Fired when the user requests to search for a query\n   *\n   * @event paper-search-search\n   */\n  /**\n   * Fired when the user taps the clear icon\n   *\n   * @event paper-search-clear\n   */\n\n  static get properties() {\n    return {\n      /**\n       * Text for which the user is searching\n       */\n      query: {\n        type: String,\n        notify: true,\n        value: \"\"\n      },\n      /**\n       * Whether to hide the Filter button. Set attribute \"hide-filter-button\" to do so.\n       */\n      hideFilterButton: {\n        type: Boolean,\n        value: false\n      },\n      /**\n       * Whether to disable the Filter button. Set attribute \"disable-filter-button\" to do so.\n       */\n      disableFilterButton: {\n        type: Boolean,\n        value: false\n      },\n      /**\n       * Number of filters the user has been selected (shown in the badge) (optional)\n       */\n      nrSelectedFilters: {\n        type: Number,\n        value: 0\n      },\n      /**\n       * Icon shown in the search background\n       */\n      icon: {\n        type: String,\n        value: \"search\"\n      },\n      /**\n       * Text shown in the search box if the user didn't enter any query\n       */\n      placeholder: {\n        type: String,\n        value: \"Search\"\n      }\n    };\n  }\n\n  focus() {\n    this.shadowRoot.querySelector(\"#input\").focus();\n  }\n  // Private methods\n  _filter(e) {\n    this.dispatchEvent(\n      new CustomEvent(\"paper-search-filter\", {\n        bubbles: true,\n        cancelable: true,\n        composed: true,\n        detail: true\n      })\n    );\n  }\n  constructor() {\n    super();\n    setTimeout(() => {\n      this.addEventListener(\"keypress\", this._search.bind(this));\n    }, 0);\n  }\n  _clear() {\n    this.query = \"\";\n    this.shadowRoot.querySelector(\"#input\").focus();\n    this.dispatchEvent(\n      new CustomEvent(\"paper-search-clear\", {\n        bubbles: true,\n        cancelable: true,\n        composed: true,\n        detail: true\n      })\n    );\n  }\n  _search(e) {\n    if (e.keyCode == 13) {\n      //Enter\n      this.dispatchEvent(\n        new CustomEvent(\"paper-search-search\", {\n          bubbles: true,\n          cancelable: true,\n          composed: true,\n          detail: true\n        })\n      );\n      return false;\n    }\n  }\n}\nwindow.customElements.define(PaperSearchBar.tag, PaperSearchBar);\nexport { PaperSearchBar };\n","import { PolymerElement } from \"@polymer/polymer/polymer-element.js\";\nclass PaperFilterDialog extends PolymerElement {\n  static get tag() {\n    return \"paper-filter-dialog\";\n  }\n\n  /**\n   * Fired when the user requests to save the filter selection\n   *\n   * @event save\n   */\n\n  static get properties() {\n    return {\n      /**\n       * All filters from which the user can choose\n       */\n      filters: Array,\n      /**\n       * All filters that have been selected by the user, e.g. `{ age: [ \"child\", \"teen\" ] }`\n       */\n      selectedFilters: {\n        type: Object,\n        notify: true,\n        value: {}\n      },\n\n      /**\n       * Text for the reset button. Use this property to localize the element.\n       */\n      resetButton: {\n        type: String,\n        value: \"Reset\"\n      },\n\n      /**\n       * Text for the save button. Use this property to localize the element.\n       */\n      saveButton: {\n        type: String,\n        value: \"Save filters\"\n      },\n\n      /**\n       * Label shown if no values are selected for a filter. Use this property to localize the element.\n       */\n      noValuesLabel: {\n        type: String,\n        value: \"No filters yet\"\n      },\n\n      /**\n       * Internal copy that is changed. Copied back to original variable only once the user clicks on [Apply]\n       */\n      _selectedFilters: {\n        type: Object,\n        value: {}\n      },\n      _selectedFilter: Object,\n      _selectedFilterValues: {\n        type: Array,\n        value: []\n      }\n    };\n  }\n\n  // Public methods\n  /**\n   * Opens the filter dialog\n   */\n  open() {\n    // Attach dialog to the body to ensure it's on top of all existing overlays\n    // XXX - Known issue: this generates addEventListener errors from a11y\n    document.body.appendChild(this);\n\n    // Wait until dialog is added to the DOM (required for Safari)\n    setTimeout(\n      function() {\n        this.shadowRoot.querySelector(\"#dialog\").open();\n\n        // Clone selected filters, so it can be changed without touching the external property\n        this._selectedFilters = Object.assign({}, this.selectedFilters);\n      }.bind(this),\n      1\n    );\n  }\n\n  close() {\n    this.shadowRoot.querySelector(\"#dialog\").close();\n  }\n\n  /**\n   * Handles if the user taps on a filter\n   */\n  _tapSelectFilter(e) {\n    this.shadowRoot.querySelector(\"#selector\").select(e.model.filter);\n\n    this._preselectFilterValues();\n  }\n\n  /**\n   * Separate function for unit testing\n   */\n  _preselectFilterValues() {\n    // Check all values that are selected\n    var selectedValueIds = this._selectedFilters[this._selectedFilter.id];\n    var isSelected = function(value) {\n      return (\n        Boolean(selectedValueIds) && selectedValueIds.indexOf(value.id) >= 0\n      );\n    };\n    this._selectedFilterValues = this._selectedFilter.values.map(function(\n      value\n    ) {\n      return Object.assign({}, value, {\n        selected: isSelected(value)\n      });\n    });\n  }\n  _tapReset(e) {\n    this._selectedFilters = {};\n  }\n  _tapApply(e) {\n    this.selectedFilters = this._selectedFilters;\n\n    this.dispatchEvent(\n      new CustomEvent(\"save\", {\n        bubbles: true,\n        cancelable: true,\n        composed: true,\n        detail: true\n      })\n    );\n  }\n  _tapSelectValues(e) {\n    // Captured IDs of the selected items\n    const selectedValues = this._selectedFilterValues\n      .filter(function(value) {\n        return value.selected;\n      })\n      .map(function(value) {\n        return value.id;\n      });\n    this._selectedFilters = Object.assign({}, this._selectedFilters, {\n      [this._selectedFilter.id]: selectedValues\n    });\n\n    this.shadowRoot.querySelector(\"#selector\").deselect(this._selectedFilter);\n  }\n\n  /**\n   * True if any filter was set\n   * @param  {[type]} selectedFilters  [description]\n   * @return {[type]}                   [description]\n   */\n  _hasSelectedFilters(selectedFilters) {\n    // Iterate until we find a filter that is selected\n    for (selectedFilter in selectedFilters) {\n      if (selectedFilters[selectedFilter].length > 0) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n  // Returns the concated names of the selected values for a specific filter\n  _getSelectedValuesNames(filter, _selectedFilters) {\n    var selectedValueIds = _selectedFilters[filter.id];\n    if (!filter.values || !selectedValueIds) {\n      return this.noValuesLabel;\n    }\n\n    // Capture names of all selected values\n    var names = filter.values\n      .filter(function(value) {\n        // Only consider values that are selected\n        return selectedValueIds.indexOf(value.id) >= 0;\n      })\n      .map(function(value) {\n        // Capture name of the selected value\n        return value.name;\n      });\n\n    return names.length > 0 ? names.join(\", \") : this.noValuesLabel;\n  }\n}\nwindow.customElements.define(PaperFilterDialog.tag, PaperFilterDialog);\nexport { PaperFilterDialog };\n","import { html, PolymerElement } from \"@polymer/polymer/polymer-element.js\";\nimport \"./paper-search-bar.js\";\nimport \"./paper-filter-dialog.js\";\n\nclass PaperSearchPanel extends PolymerElement {\n  static get tag() {\n    return \"paper-search-panel\";\n  }\n\n  /**\n   * Fired when the user changes the parameter defining the currently shown items\n   *\n   * @event change-request-params\n   */\n  /**\n   * Fired when the user requests to search for a query\n   *\n   * @event search\n   */\n\n  static get properties() {\n    return {\n      /**\n       * Query for which the user was searching\n       */\n      search: {\n        type: String,\n        observer: \"_onChangeRequest\",\n        notify: true\n      },\n      /**\n       * All filters from which the user can choose\n       */\n      filters: Object,\n      /**\n       * All filters that have been selected by the user, e.g. `{ age: [ \"child\", \"teen\" ] }`\n       */\n      selectedFilters: {\n        type: Object,\n        observer: \"_onChangeRequest\",\n        notify: true,\n        value: {}\n      },\n      /**\n       * Items that are currently shown in the lister\n       */\n      items: Array,\n      /**\n       * True if further items could be loaded\n       */\n      hasMore: {\n        type: Boolean,\n        value: false\n      },\n\n      /**\n       * True if items are currently loaded\n       */\n      loading: {\n        type: Boolean,\n        value: false\n      },\n\n      /**\n       * Whether to hide the Filter button. Set attribute \"hide-filter-button\" to do so.\n       */\n      hideFilterButton: {\n        type: Boolean,\n        value: false\n      },\n\n      /**\n       * Number of items loaded per page (i.e. for each click on [more])\n       */\n      count: {\n        type: Number,\n        notify: true,\n        value: 20\n      },\n      /**\n       * Icon shown in the search background\n       */\n      icon: {\n        type: String,\n        value: \"search\"\n      },\n      /**\n       * Text shown in the search box if the user didn't enter any query\n       */\n      placeholder: {\n        type: String,\n        value: \"Search\"\n      },\n\n      /**\n       * Text shown if no results are found. Use this property to localize the element.\n       */\n      noResultsText: {\n        type: String,\n        value: \"No matching results found.\"\n      },\n\n      /**\n       * Text for the more button to load more data. Use this property to localize the element.\n       */\n      moreButton: {\n        type: String,\n        value: \"More\"\n      },\n\n      /**\n       * Text for the reset button in the filter dialog. Use this property to localize the element.\n       */\n      resetButton: String,\n\n      /**\n       * Text for the save button in the filter dialog. Use this property to localize the element.\n       */\n      saveButton: String,\n\n      /**\n       * Label shown if no values are selected for a filter. Use this property to localize the element.\n       */\n      noValuesLabel: String,\n\n      _hasItems: {\n        type: Boolean,\n        computed: \"_computeHasItems(items)\",\n        value: false\n      }\n    };\n  }\n\n  getPaperSearchBarInstance() {\n    return this.shadowRoot.querySelector(\"#paperSearchBar\");\n  }\n\n  // Private methods\n  _loadMore() {\n    this.count += 20;\n    this._updateData();\n  }\n  _computeHasItems(items) {\n    return typeof items !== \"undefined\" && items.length > 0;\n  }\n  _showNoResults(_hasItems, loading) {\n    return !_hasItems && !loading;\n  }\n  _onChangeRequest(newValue, oldValue) {\n    // Ignore initial setting of properties (caller is supposed to trigger this call automatically)\n    if (typeof oldValue !== \"undefined\") {\n      // Set back to default to avoid endless listers\n      this.count = 20;\n      this._updateData();\n    }\n  }\n  _updateData() {\n    this.dispatchEvent(\n      new CustomEvent(\"change-request-params\", {\n        bubbles: true,\n        cancelable: true,\n        composed: true,\n        detail: true\n      })\n    );\n  }\n  _onFilter() {\n    this.shadowRoot.querySelector(\"#filterDialog\").open();\n  }\n  _onSearch() {\n    this.dispatchEvent(\n      new CustomEvent(\"search\", {\n        bubbles: true,\n        cancelable: true,\n        composed: true,\n        detail: true\n      })\n    );\n  }\n  // Counts the selected filters\n  _getNrSelectedFilters(selectedFilters) {\n    if (Object.keys(selectedFilters).length <= 0) {\n      return 0;\n    }\n\n    var nrSelectedFilters = Object.keys(selectedFilters)\n      .map(function(key) {\n        // Returns number of selected value for a filter\n        return selectedFilters[key].length;\n      })\n      .reduce(function(sum, value) {\n        // Sum up the selected values across filters\n        return sum + value;\n      });\n\n    return nrSelectedFilters;\n  }\n\n  _disableFilterButton(filters) {\n    return !(filters && filters.length > 0);\n  }\n}\nwindow.customElements.define(PaperSearchPanel.tag, PaperSearchPanel);\nexport { PaperSearchPanel };\n"],"names":["PaperSearchBar","setTimeout","addEventListener","_this","_search","bind","mixinBehaviors","IronA11yKeysBehavior","PolymerElement","shadowRoot","querySelector","focus","e","dispatchEvent","CustomEvent","bubbles","cancelable","composed","detail","query","type","String","notify","value","hideFilterButton","Boolean","disableFilterButton","nrSelectedFilters","Number","icon","placeholder","keyCode","window","customElements","define","tag","PaperFilterDialog","document","body","appendChild","this","open","_selectedFilters","Object","assign","selectedFilters","close","select","model","filter","_preselectFilterValues","selectedValueIds","_selectedFilter","id","isSelected","indexOf","_selectedFilterValues","values","map","selected","selectedValues","deselect","selectedFilter","length","noValuesLabel","names","name","join","filters","Array","resetButton","saveButton","PaperSearchPanel","count","_updateData","items","_hasItems","loading","newValue","oldValue","keys","key","reduce","sum","search","observer","hasMore","noResultsText","moreButton","computed"],"mappings":"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"}